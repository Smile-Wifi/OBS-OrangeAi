<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scene Manager - StreamPro Studio</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#00d4ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="StreamPro Studio">
    <meta name="application-name" content="StreamPro Studio">
    <meta name="msapplication-TileColor" content="#00d4ff">
    <meta name="msapplication-TileImage" content="resources/icon-192.png">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="resources/icon-32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="resources/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="resources/icon-512.png">
    <link rel="apple-touch-icon" href="resources/icon-192.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-bg: #0d0d0d;
            --secondary-bg: #1a1a1a;
            --panel-bg: #2d2d2d;
            --accent-blue: #00d4ff;
            --accent-green: #00ff88;
            --accent-orange: #ff8c00;
            --accent-red: #ff4757;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-color: #404040;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 255, 136, 0.1) 0%, transparent 50%);
        }

        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .font-display { font-family: 'Poppins', sans-serif; }

        .glass-nav {
            backdrop-filter: blur(20px);
            background: rgba(26, 26, 26, 0.8);
            border-bottom: 1px solid rgba(64, 64, 64, 0.3);
        }

        .panel {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-blue), #0099cc);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(0, 212, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.4);
        }

        .btn-secondary {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: var(--panel-bg);
            border-color: var(--accent-blue);
        }

        .scene-builder {
            min-height: 500px;
            background: var(--secondary-bg);
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }

        .scene-builder.drag-over {
            border-color: var(--accent-blue);
            background: rgba(0, 212, 255, 0.05);
        }

        .source-library {
            max-height: 600px;
            overflow-y: auto;
        }

        .source-type {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: grab;
            transition: all 0.3s ease;
        }

        .source-type:hover {
            border-color: var(--accent-blue);
            background: var(--panel-bg);
            transform: translateY(-2px);
        }

        .source-type:active {
            cursor: grabbing;
        }

        .source-type.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .scene-preview {
            width: 100%;
            height: 300px;
            background: #000;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .scene-item {
            position: absolute;
            border: 2px solid var(--accent-blue);
            border-radius: 4px;
            cursor: move;
            transition: all 0.3s ease;
        }

        .scene-item:hover {
            border-color: var(--accent-green);
            box-shadow: 0 0 12px rgba(0, 255, 136, 0.5);
        }

        .scene-item.selected {
            border-color: var(--accent-orange);
            box-shadow: 0 0 12px rgba(255, 140, 0, 0.7);
        }

        .scene-item.resize-handle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: var(--accent-blue);
            border-radius: 50%;
            cursor: se-resize;
        }

        .scene-item.resize-handle.bottom-right {
            bottom: -4px;
            right: -4px;
        }

        .source-properties {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }

        .property-group {
            margin-bottom: 16px;
        }

        .property-label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .property-input {
            width: 100%;
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 8px 12px;
            color: var(--text-primary);
        }

        .property-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .slider-container {
            display: flex;
            align-items: center;
            space-x: 12px;
        }

        .slider {
            flex: 1;
            height: 6px;
            background: var(--secondary-bg);
            border-radius: 3px;
            position: relative;
            cursor: pointer;
        }

        .slider-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-green));
            border-radius: 3px;
            transition: width 0.2s ease;
        }

        .slider-handle {
            position: absolute;
            top: -5px;
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .slider-handle:hover {
            transform: scale(1.2);
        }

        .scene-templates {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .template-card {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 212, 255, 0.2);
        }

        .template-preview {
            width: 100%;
            height: 120px;
            background: var(--secondary-bg);
            border-radius: 4px;
            margin-bottom: 12px;
            position: relative;
            overflow: hidden;
        }

        .layer-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .layer-item {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: between;
        }

        .layer-item:hover {
            background: var(--panel-bg);
        }

        .layer-item.selected {
            border-color: var(--accent-blue);
            background: rgba(0, 212, 255, 0.1);
        }

        .layer-visibility {
            margin-left: auto;
            cursor: pointer;
        }

        .fade-in {
            opacity: 0;
            transform: translateY(20px);
        }

        .transition-preview {
            width: 100%;
            height: 200px;
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            margin-bottom: 16px;
        }

        @media (max-width: 768px) {
            .scene-templates {
                grid-template-columns: 1fr;
            }
            
            .source-library {
                max-height: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="glass-nav fixed top-0 left-0 right-0 z-50 px-6 py-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-8">
                <h1 class="font-display text-2xl font-bold text-white">StreamPro Studio</h1>
                <div class="hidden md:flex space-x-6">
                    <a href="index.html" class="text-gray-300 hover:text-blue-400 transition-colors font-medium">Dashboard</a>
                    <a href="scenes.html" class="text-white hover:text-blue-400 transition-colors font-medium border-b-2 border-blue-400">Scenes</a>
                    <a href="audio.html" class="text-gray-300 hover:text-blue-400 transition-colors font-medium">Audio</a>
                    <a href="settings.html" class="text-gray-300 hover:text-blue-400 transition-colors font-medium">Settings</a>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button class="btn-primary" onclick="saveScene()">Save Scene</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-24 px-6 pb-6">
        <!-- Page Header -->
        <section class="fade-in mb-8">
            <div class="text-center">
                <h2 class="font-display text-4xl md:text-5xl font-bold mb-4">
                    <span class="text-blue-400">Scene</span>
                    <span class="text-white">Manager</span>
                </h2>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    Create professional streaming scenes with drag-and-drop source management, layer controls, and transition effects.
                </p>
            </div>
        </section>

        <!-- Main Interface -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8">
            <!-- Source Library -->
            <div class="lg:col-span-1">
                <div class="panel p-6">
                    <h3 class="font-display text-xl font-semibold mb-4">Source Library</h3>
                    <div class="source-library">
                        <div class="source-type" draggable="true" data-source-type="webcam">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 0v7.268a2 2 0 000 3.464V16a2 2 0 002 2h12a2 2 0 002-2v-1.268a2 2 0 000-3.464V5a2 2 0 00-2-2H4zm6 9a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="font-medium">Webcam</h4>
                                    <p class="text-xs text-gray-400">Video capture device</p>
                                </div>
                            </div>
                        </div>

                        <div class="source-type" draggable="true" data-source-type="game-capture">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M5 4a1 1 0 00-2 0v7.268a2 2 0 000 3.464V16a1 1 0 102 0v-1.268a2 2 0 000-3.464V4zM11 4a1 1 0 10-2 0v1.268a2 2 0 000 3.464V16a1 1 0 102 0V8.732a2 2 0 000-3.464V4zM16 3a1 1 0 011 1v7.268a2 2 0 010 3.464V16a1 1 0 11-2 0v-1.268a2 2 0 010-3.464V4a1 1 0 011-1z"/>
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="font-medium">Game Capture</h4>
                                    <p class="text-xs text-gray-400">Capture game window</p>
                                </div>
                            </div>
                        </div>

                        <div class="source-type" draggable="true" data-source-type="display-capture">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 011 1v8a1 1 0 01-1 1H4a1 1 0 01-1-1V4zm2 2v4h10V6H5z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="font-medium">Display Capture</h4>
                                    <p class="text-xs text-gray-400">Full screen capture</p>
                                </div>
                            </div>
                        </div>

                        <div class="source-type" draggable="true" data-source-type="image">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="font-medium">Image</h4>
                                    <p class="text-xs text-gray-400">Static image source</p>
                                </div>
                            </div>
                        </div>

                        <div class="source-type" draggable="true" data-source-type="text">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-10 h-10 bg-indigo-500 rounded-lg flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M4 2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="font-medium">Text</h4>
                                    <p class="text-xs text-gray-400">Dynamic text overlay</p>
                                </div>
                            </div>
                        </div>

                        <div class="source-type" draggable="true" data-source-type="browser">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M4.083 9h1.946c.089-1.546.383-2.97.837-4.118A6.004 6.004 0 004.083 9zM10 2a8 8 0 100 16 8 8 0 000-16zm0 2c-.076 0-.232.032-.465.262-.238.234-.497.623-.737 1.182-.389.907-.673 2.142-.766 3.556h3.936c-.093-1.414-.377-2.649-.766-3.556-.24-.56-.5-.948-.737-1.182C10.232 4.032 10.076 4 10 4zm3.971 5c-.089-1.546-.383-2.97-.837-4.118A6.004 6.004 0 0115.917 9h-1.946zm-2.003 2H8.032c.093 1.414.377 2.649.766 3.556.24.56.5.948.737 1.182.233.23.389.262.465.262.076 0 .232-.032.465-.262.238-.234.498-.623.737-1.182.389-.907.673-2.142.766-3.556zm1.166 4.118c.454-1.147.748-2.572.837-4.118h1.946a6.004 6.004 0 01-2.783 4.118zm-6.268 0C6.412 13.97 6.118 12.546 6.03 11H4.083a6.004 6.004 0 002.783 4.118z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="font-medium">Browser Source</h4>
                                    <p class="text-xs text-gray-400">Web page overlay</p>
                                </div>
                            </div>
                        </div>

                        <div class="source-type" draggable="true" data-source-type="media">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-10 h-10 bg-pink-500 rounded-lg flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="font-medium">Media Source</h4>
                                    <p class="text-xs text-gray-400">Video/audio files</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scene Builder -->
            <div class="lg:col-span-2">
                <div class="panel p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-display text-xl font-semibold">Scene Builder</h3>
                        <div class="flex space-x-2">
                            <button class="btn-secondary text-sm" onclick="clearScene()">Clear</button>
                            <button class="btn-secondary text-sm" onclick="previewScene()">Preview</button>
                        </div>
                    </div>
                    
                    <div class="scene-builder" id="scene-builder">
                        <div class="scene-preview" id="scene-preview">
                            <!-- Scene items will be added here dynamically -->
                            <div class="absolute inset-0 flex items-center justify-center text-gray-500">
                                <div class="text-center">
                                    <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
                                    </svg>
                                    <p>Drag sources here to build your scene</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Layer Controls -->
                    <div class="mt-6">
                        <h4 class="font-medium mb-3">Layers</h4>
                        <div class="layer-list" id="layer-list">
                            <div class="layer-item" data-layer="0">
                                <span>Background</span>
                                <div class="layer-visibility">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Properties Panel -->
            <div class="lg:col-span-1">
                <div class="panel p-6">
                    <h3 class="font-display text-xl font-semibold mb-4">Properties</h3>
                    <div id="properties-panel">
                        <div class="text-gray-400 text-center py-8">
                            <svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                            </svg>
                            <p>Select an item to edit properties</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scene Templates -->
        <div class="panel p-6 mb-8">
            <h3 class="font-display text-xl font-semibold mb-4">Scene Templates</h3>
            <p class="text-gray-400 mb-6">Quick-start templates for common streaming scenarios</p>
            
            <div class="scene-templates">
                <div class="template-card" onclick="applyTemplate('gaming')">
                    <div class="template-preview">
                        <div class="absolute inset-2 bg-gradient-to-br from-purple-600 to-blue-600 rounded">
                            <div class="absolute top-1 right-1 w-8 h-6 bg-gray-800 rounded opacity-80"></div>
                            <div class="absolute bottom-8 left-2 right-2 h-4 bg-gradient-to-r from-pink-500 to-purple-500 rounded opacity-90"></div>
                        </div>
                    </div>
                    <h4 class="font-medium mb-2">Gaming Setup</h4>
                    <p class="text-sm text-gray-400">Game capture + webcam + overlay</p>
                </div>

                <div class="template-card" onclick="applyTemplate('just-chatting')">
                    <div class="template-preview">
                        <div class="absolute inset-2 bg-gradient-to-br from-green-600 to-teal-600 rounded">
                            <div class="absolute top-2 left-2 right-2 h-12 bg-gray-800 rounded opacity-80"></div>
                            <div class="absolute bottom-8 left-2 right-2 h-4 bg-gradient-to-r from-green-400 to-blue-400 rounded opacity-90"></div>
                        </div>
                    </div>
                    <h4 class="font-medium mb-2">Just Chatting</h4>
                    <p class="text-sm text-gray-400">Full-screen webcam + chat overlay</p>
                </div>

                <div class="template-card" onclick="applyTemplate('intermission')">
                    <div class="template-preview">
                        <div class="absolute inset-2 bg-gradient-to-br from-orange-600 to-red-600 rounded">
                            <div class="absolute inset-4 bg-gray-800 rounded opacity-80 flex items-center justify-center">
                                <span class="text-xs">BREAK</span>
                            </div>
                            <div class="absolute bottom-8 left-2 right-2 h-4 bg-gradient-to-r from-orange-400 to-red-400 rounded opacity-90"></div>
                        </div>
                    </div>
                    <h4 class="font-medium mb-2">Intermission</h4>
                    <p class="text-sm text-gray-400">Break screen + countdown timer</p>
                </div>

                <div class="template-card" onclick="applyTemplate('starting-soon')">
                    <div class="template-preview">
                        <div class="absolute inset-2 bg-gradient-to-br from-gray-600 to-gray-800 rounded">
                            <div class="absolute inset-4 bg-gray-900 rounded opacity-80 flex items-center justify-center">
                                <span class="text-xs">STARTING SOON</span>
                            </div>
                            <div class="absolute bottom-8 left-2 right-2 h-4 bg-gradient-to-r from-gray-400 to-gray-600 rounded opacity-90"></div>
                        </div>
                    </div>
                    <h4 class="font-medium mb-2">Starting Soon</h4>
                    <p class="text-sm text-gray-400">Pre-stream screen + music</p>
                </div>

                <div class="template-card" onclick="applyTemplate('podcast')">
                    <div class="template-preview">
                        <div class="absolute inset-2 bg-gradient-to-br from-indigo-600 to-purple-600 rounded">
                            <div class="absolute top-2 left-2 w-12 h-12 bg-gray-800 rounded-full opacity-80"></div>
                            <div class="absolute top-2 right-2 w-12 h-12 bg-gray-800 rounded-full opacity-80"></div>
                            <div class="absolute bottom-8 left-2 right-2 h-4 bg-gradient-to-r from-indigo-400 to-purple-400 rounded opacity-90"></div>
                        </div>
                    </div>
                    <h4 class="font-medium mb-2">Podcast Setup</h4>
                    <p class="text-sm text-gray-400">Multi-person discussion layout</p>
                </div>

                <div class="template-card" onclick="applyTemplate('tutorial')">
                    <div class="template-preview">
                        <div class="absolute inset-2 bg-gradient-to-br from-yellow-600 to-orange-600 rounded">
                            <div class="absolute top-2 left-2 right-2 h-16 bg-gray-800 rounded opacity-80"></div>
                            <div class="absolute bottom-2 left-2 w-12 h-12 bg-gray-800 rounded opacity-80"></div>
                            <div class="absolute bottom-8 left-2 right-2 h-4 bg-gradient-to-r from-yellow-400 to-orange-400 rounded opacity-90"></div>
                        </div>
                    </div>
                    <h4 class="font-medium mb-2">Tutorial Mode</h4>
                    <p class="text-sm text-gray-400">Screen share + webcam + annotations</p>
                </div>
            </div>
        </div>

        <!-- Transition Settings -->
        <div class="panel p-6">
            <h3 class="font-display text-xl font-semibold mb-4">Transition Settings</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-medium mb-3">Transition Type</h4>
                    <select class="property-input mb-4" id="transition-type">
                        <option value="fade">Fade</option>
                        <option value="slide">Slide</option>
                        <option value="wipe">Wipe</option>
                        <option value="stinger">Stinger</option>
                    </select>
                    
                    <div class="property-group">
                        <label class="property-label">Duration (ms)</label>
                        <div class="slider-container">
                            <div class="slider" id="transition-duration-slider">
                                <div class="slider-fill" style="width: 50%"></div>
                                <div class="slider-handle" style="left: 50%"></div>
                            </div>
                            <span class="font-mono text-sm ml-3">500ms</span>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="font-medium mb-3">Preview</h4>
                    <div class="transition-preview" id="transition-preview">
                        <div class="absolute inset-0 flex items-center justify-center text-gray-400">
                            <span>Transition Preview</span>
                        </div>
                    </div>
                    <button class="btn-secondary text-sm w-full" onclick="previewTransition()">Preview Transition</button>
                </div>
            </div>
        </div>
    </main>

    <script src="app.js"></script>
    <script>
        // Scene Manager functionality
        class SceneManager {
            constructor() {
                this.sceneItems = [];
                this.selectedItem = null;
                this.layerCount = 1;
                this.init();
            }

            init() {
                this.setupDragAndDrop();
                this.setupPropertyControls();
                this.animatePageLoad();
            }

            setupDragAndDrop() {
                // Source library drag handlers
                document.querySelectorAll('.source-type').forEach(source => {
                    source.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', e.target.dataset.sourceType);
                        e.target.classList.add('dragging');
                    });

                    source.addEventListener('dragend', (e) => {
                        e.target.classList.remove('dragging');
                    });
                });

                // Scene builder drop handlers
                const sceneBuilder = document.getElementById('scene-builder');
                const scenePreview = document.getElementById('scene-preview');

                sceneBuilder.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    sceneBuilder.classList.add('drag-over');
                });

                sceneBuilder.addEventListener('dragleave', () => {
                    sceneBuilder.classList.remove('drag-over');
                });

                sceneBuilder.addEventListener('drop', (e) => {
                    e.preventDefault();
                    sceneBuilder.classList.remove('drag-over');
                    
                    const sourceType = e.dataTransfer.getData('text/plain');
                    const rect = scenePreview.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    
                    this.addSourceToScene(sourceType, x, y);
                });
            }

            addSourceToScene(sourceType, x, y) {
                const scenePreview = document.getElementById('scene-preview');
                const sourceElement = document.createElement('div');
                
                sourceElement.className = 'scene-item';
                sourceElement.style.left = Math.max(0, Math.min(x - 50, scenePreview.offsetWidth - 100)) + 'px';
                sourceElement.style.top = Math.max(0, Math.min(y - 25, scenePreview.offsetHeight - 50)) + 'px';
                sourceElement.style.width = '100px';
                sourceElement.style.height = '50px';
                sourceElement.dataset.sourceType = sourceType;
                sourceElement.dataset.layer = this.layerCount++;
                
                // Add source-specific styling
                const colors = {
                    webcam: 'bg-blue-500',
                    'game-capture': 'bg-purple-500',
                    'display-capture': 'bg-green-500',
                    image: 'bg-orange-500',
                    text: 'bg-indigo-500',
                    browser: 'bg-red-500',
                    media: 'bg-pink-500'
                };
                
                sourceElement.classList.add(colors[sourceType] || 'bg-gray-500');
                sourceElement.innerHTML = `
                    <div class="w-full h-full flex items-center justify-center text-xs font-medium text-white">
                        ${sourceType.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}
                    </div>
                    <div class="resize-handle bottom-right"></div>
                `;
                
                // Add click handler for selection
                sourceElement.addEventListener('click', () => {
                    this.selectSceneItem(sourceElement);
                });
                
                // Add drag handlers for repositioning
                this.makeDraggable(sourceElement);
                
                scenePreview.appendChild(sourceElement);
                this.sceneItems.push(sourceElement);
                
                // Update layer list
                this.updateLayerList();
                
                // Animate in
                anime({
                    targets: sourceElement,
                    scale: [0, 1],
                    opacity: [0, 1],
                    duration: 300,
                    easing: 'easeOutBack'
                });
            }

            makeDraggable(element) {
                let isDragging = false;
                let startX, startY, initialX, initialY;

                element.addEventListener('mousedown', (e) => {
                    if (e.target.classList.contains('resize-handle')) return;
                    
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    initialX = element.offsetLeft;
                    initialY = element.offsetTop;
                    
                    element.style.cursor = 'grabbing';
                    e.preventDefault();
                });

                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    
                    const deltaX = e.clientX - startX;
                    const deltaY = e.clientY - startY;
                    
                    const newX = Math.max(0, Math.min(initialX + deltaX, element.parentElement.offsetWidth - element.offsetWidth));
                    const newY = Math.max(0, Math.min(initialY + deltaY, element.parentElement.offsetHeight - element.offsetHeight));
                    
                    element.style.left = newX + 'px';
                    element.style.top = newY + 'px';
                });

                document.addEventListener('mouseup', () => {
                    if (isDragging) {
                        isDragging = false;
                        element.style.cursor = 'move';
                    }
                });
            }

            selectSceneItem(element) {
                // Remove selection from all items
                document.querySelectorAll('.scene-item').forEach(item => {
                    item.classList.remove('selected');
                });
                
                // Select current item
                element.classList.add('selected');
                this.selectedItem = element;
                
                // Update properties panel
                this.updatePropertiesPanel(element);
            }

            updatePropertiesPanel(element) {
                const propertiesPanel = document.getElementById('properties-panel');
                const sourceType = element.dataset.sourceType;
                
                propertiesPanel.innerHTML = `
                    <div class="source-properties">
                        <h4 class="font-medium mb-4">${sourceType.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())} Properties</h4>
                        
                        <div class="property-group">
                            <label class="property-label">Position X</label>
                            <input type="number" class="property-input" value="${element.offsetLeft}" onchange="updateSourcePosition('x', this.value)">
                        </div>
                        
                        <div class="property-group">
                            <label class="property-label">Position Y</label>
                            <input type="number" class="property-input" value="${element.offsetTop}" onchange="updateSourcePosition('y', this.value)">
                        </div>
                        
                        <div class="property-group">
                            <label class="property-label">Width</label>
                            <input type="number" class="property-input" value="${element.offsetWidth}" onchange="updateSourceSize('width', this.value)">
                        </div>
                        
                        <div class="property-group">
                            <label class="property-label">Height</label>
                            <input type="number" class="property-input" value="${element.offsetHeight}" onchange="updateSourceSize('height', this.value)">
                        </div>
                        
                        <div class="property-group">
                            <label class="property-label">Opacity</label>
                            <div class="slider-container">
                                <div class="slider" onclick="updateOpacity(event)">
                                    <div class="slider-fill" style="width: 100%"></div>
                                    <div class="slider-handle" style="left: 100%"></div>
                                </div>
                                <span class="font-mono text-sm ml-3">100%</span>
                            </div>
                        </div>
                        
                        <div class="property-group">
                            <button class="btn-secondary text-sm w-full" onclick="removeSelectedItem()">Remove Source</button>
                        </div>
                    </div>
                `;
            }

            updateLayerList() {
                const layerList = document.getElementById('layer-list');
                layerList.innerHTML = '<div class="layer-item" data-layer="0"><span>Background</span><div class="layer-visibility"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z" clip-rule="evenodd"/></svg></div></div>';
                
                this.sceneItems.forEach((item, index) => {
                    const layerItem = document.createElement('div');
                    layerItem.className = 'layer-item';
                    layerItem.dataset.layer = item.dataset.layer;
                    layerItem.innerHTML = `
                        <span>${item.dataset.sourceType.replace('-', ' ')}</span>
                        <div class="layer-visibility">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    `;
                    layerList.appendChild(layerItem);
                });
            }

            animatePageLoad() {
                anime({
                    targets: '.fade-in',
                    opacity: [0, 1],
                    translateY: [20, 0],
                    duration: 800,
                    easing: 'easeOutQuad'
                });

                anime({
                    targets: '.panel',
                    opacity: [0, 1],
                    translateY: [30, 0],
                    duration: 600,
                    delay: anime.stagger(150),
                    easing: 'easeOutQuad'
                });
            }
        }

        // Global functions
        function updateSourcePosition(axis, value) {
            if (window.sceneManager.selectedItem) {
                window.sceneManager.selectedItem.style[axis === 'x' ? 'left' : 'top'] = value + 'px';
            }
        }

        function updateSourceSize(dimension, value) {
            if (window.sceneManager.selectedItem) {
                window.sceneManager.selectedItem.style[dimension] = value + 'px';
            }
        }

        function updateOpacity(event) {
            const slider = event.currentTarget;
            const rect = slider.getBoundingClientRect();
            const percentage = Math.max(0, Math.min(100, ((event.clientX - rect.left) / rect.width) * 100));
            
            const fill = slider.querySelector('.slider-fill');
            const handle = slider.querySelector('.slider-handle');
            const valueDisplay = slider.nextElementSibling;
            
            fill.style.width = percentage + '%';
            handle.style.left = percentage + '%';
            valueDisplay.textContent = Math.round(percentage) + '%';
            
            if (window.sceneManager.selectedItem) {
                window.sceneManager.selectedItem.style.opacity = percentage / 100;
            }
        }

        function removeSelectedItem() {
            if (window.sceneManager.selectedItem) {
                window.sceneManager.selectedItem.remove();
                window.sceneManager.sceneItems = window.sceneManager.sceneItems.filter(item => item !== window.sceneManager.selectedItem);
                window.sceneManager.selectedItem = null;
                window.sceneManager.updateLayerList();
                
                document.getElementById('properties-panel').innerHTML = `
                    <div class="text-gray-400 text-center py-8">
                        <svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                        </svg>
                        <p>Select an item to edit properties</p>
                    </div>
                `;
            }
        }

        function clearScene() {
            document.querySelectorAll('.scene-item').forEach(item => item.remove());
            window.sceneManager.sceneItems = [];
            window.sceneManager.updateLayerList();
        }

        function previewScene() {
            alert('Scene preview would open in a new window');
        }

        function applyTemplate(templateType) {
            clearScene();
            
            const templates = {
                gaming: [
                    { type: 'game-capture', x: 50, y: 50, width: 800, height: 450 },
                    { type: 'webcam', x: 700, y: 350, width: 200, height: 150 },
                    { type: 'overlay', x: 0, y: 0, width: 800, height: 50 }
                ],
                'just-chatting': [
                    { type: 'webcam', x: 200, y: 50, width: 400, height: 300 },
                    { type: 'overlay', x: 0, y: 0, width: 800, height: 50 }
                ],
                intermission: [
                    { type: 'text', x: 300, y: 150, width: 200, height: 100 },
                    { type: 'overlay', x: 0, y: 0, width: 800, height: 50 }
                ]
            };
            
            const template = templates[templateType] || [];
            template.forEach(source => {
                window.sceneManager.addSourceToScene(source.type, source.x, source.y);
                const lastItem = window.sceneManager.sceneItems[window.sceneManager.sceneItems.length - 1];
                lastItem.style.width = source.width + 'px';
                lastItem.style.height = source.height + 'px';
            });
            
            window.sceneManager.showNotification(`Applied ${templateType} template`);
        }

        function previewTransition() {
            const transitionPreview = document.getElementById('transition-preview');
            anime({
                targets: transitionPreview,
                opacity: [1, 0, 1],
                duration: 500,
                easing: 'easeInOutQuad'
            });
        }

        function saveScene() {
            window.sceneManager.showNotification('Scene saved successfully!');
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.sceneManager = new SceneManager();
        });
    </script>
</body>
</html>